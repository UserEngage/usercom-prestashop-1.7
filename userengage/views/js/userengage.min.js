/*
   2018 PrestaShow.pl
  @license     https://prestashow.pl/license
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");
UserEngage={debug:!1,data:[],log:function(a){UserEngage.debug&&console.log("UserEngage: "+a)},error:function(a){UserEngage.debug&&console.error("UserEngage Error: "+a)},logObj:function(a){UserEngage.debug&&(console.log("UserEngage:"),console.log(a))},pushProductEvent:function(a){UserEngage.log("sending product event with data:");UserEngage.logObj(a);"function"!==typeof userengage?UserEngage.error("base script from userengage.com not loaded"):userengage("product_event",a)},pushEvent:function(a,b){UserEngage.log("sending event."+
a+" with data:");UserEngage.logObj(b);"function"!==typeof userengage?UserEngage.error("base script from userengage.com not loaded"):userengage("event."+a,b)},event:{checkoutOption:function(a){UserEngage.pushEvent("checkout_option",a)},purchase:function(a){UserEngage.pushEvent("purchase",a)},registration:function(a){UserEngage.pushEvent("registration",a)},order:function(a){UserEngage.pushEvent("order",{step:parseInt(a)})},newsletter:function(a,b){var c=null;"undefined"===typeof window.civchat||"undefined"!==
typeof window.civchat.email&&window.civchat.email===a||(c=window.civchat,window.civchat={apiKey:window.civchat.apiKey},UserEngage.log("temporary changed window.civchat for event.newsletter_signup"),UserEngage.logObj(window.civchat));UserEngage.pushEvent("newsletter_signup",{email:a,place:b});null!==c&&setTimeout(function(){window.civchat=c;UserEngage.log("restored original window.civchat");UserEngage.logObj(c)},300)}}};
UserEngage.event.product={addToCart:function(a){this._cartUpdate("add to cart",a)},remove:function(a){this._cartUpdate("remove",a)},view:function(){this._productView("view")},liking:function(){this._productView("liking")},detail:function(){this._productView("detail")},click:function(a){a.event_type="click";UserEngage.pushProductEvent(a)},promoClick:function(a){a.event_type="promo click";UserEngage.pushProductEvent(a)},checkout:function(a){a.event_type="checkout";UserEngage.pushProductEvent(a)},refund:function(a){a.event_type=
"refund";UserEngage.pushProductEvent(a);a.event_type="return";UserEngage.pushProductEvent(a)},purchase:function(a){for(var b in a){var c=a[b];c.event_type="purchase";UserEngage.pushProductEvent(c)}},_cartUpdate:function(a,b){if(null!==b&&null!==a){a={event_type:a,product_id:b.id_product+"-"+b.id_product_attribute,name:b.name,price:b.price_wt,quantity:b.cart_quantity,category_name:b.category,product_url:b.url};null!==b.cover&&null!==b.cover.medium&&(a.image_url=b.cover.medium.url);for(var c in b.attributes)a[c]=
b.attributes[c];UserEngage.shopping_cart="undefined"===typeof prestashop.cart?[]:prestashop.cart.products;UserEngage.pushProductEvent(a)}},_productView:function(a){"undefined"!==typeof a&&a||(a="view");var b=$('#main[itemtype="https://schema.org/Product"]'),c={event_type:a};a=parseInt($("body").attr("class").replace(/.*product\-id\-([0-9]+).*/,"$1"));isNaN(a)||(c.product_id=a,$.ajax({dataType:"json",url:document.location.href,data:"ajax=1&action=refresh&"+$("#add-to-cart-or-refresh").serialize()}).success(function(a){c.product_id+=
"-"+a.id_product_attribute;b.find('[itemprop="name"]').length&&(c.name=b.find('[itemprop="name"]').text().trim());b.find('[itemprop="price"]').length&&(c.price=b.find('[itemprop="price"]').attr("content").trim().replace(/([^0-9\.,]+)/,"").replace(",","."));$(".breadcrumb a").length&&(c.category_name=$(".breadcrumb a").last().closest("li").prev("li").find("a").text().trim().toLowerCase().replace(" ","-"));b.find('[itemprop="image"]').length&&(c.image_url=b.find('[itemprop="image"]').attr("src").trim());
b.find('[itemprop="url"]').length&&(c.product_url=b.find('[itemprop="url"]').attr("content").trim());b.find(".product-variants-item").each(function(){if($(this).find("select").length){var a=$(this).find(".control-label").text().trim(),f=$(this).find("select option:selected").text().trim();c[a]=f}else $(this).find("input[type=radio]").length&&(a=$(this).find(".control-label").text().trim(),f=$(this).find("input[type=radio]:checked").next("span").text().trim(),c[a]=f)});UserEngage.pushProductEvent(c)}))}};
UserEngage.watchForRefundSubmit=function(){"order-detail"===$("body").attr("id")&&"undefined"!==typeof UserEngage.data.orderProducts&&(UserEngage.data.catchedSubmit=!1,$(document).on("submit","#order-return-form",function(a){if(!UserEngage.data.catchedSubmit)return a.preventDefault(),$('#order-products tbody input[type="checkbox"]:checked').each(function(){var a=parseInt($(this).val());"undefined"!==typeof UserEngage.data.orderProducts[a]&&(a=UserEngage.data.orderProducts[a],a.quantity=parseInt($(this).closest("tr").find("select").eq(0).val()),
UserEngage.event.product.refund(a))}),UserEngage.data.catchedSubmit=!0,setTimeout(function(){$('#order-return-form [name="submitReturnMerchandise"]').trigger("click")},200),!1}))};
$(function(){"undefined"!==typeof prestashop.cart&&"undefined"!==typeof prestashop.cart.products&&(UserEngage.shopping_cart=prestashop.cart.products);prestashop.addListener("updateCart",function(a){console.log(a);var b=null;if("undefined"!==typeof a.resp&&"undefined"!==typeof a.resp.success&&a.resp.success){for(var c in a.resp.cart.products)if(parseInt(a.resp.cart.products[c].id_product)===parseInt(a.resp.id_product)&&parseInt(a.resp.cart.products[c].id_product_attribute)===parseInt(a.resp.id_product_attribute)){b=
a.resp.cart.products[c];break}var f=null;for(d in UserEngage.shopping_cart)if(parseInt(UserEngage.shopping_cart.id_product)===parseInt(a.resp.id_product)&&parseInt(UserEngage.shopping_cart.id_product_attribute)===parseInt(a.resp.id_product_attribute)){f=a.resp.cart.products[d];break}null===f||f.cart_quantity<b.cart_quantity?UserEngage.event.product.addToCart(b):UserEngage.event.product.remove(b)}else if("undefined"!==typeof a.reason&&"undefined"!==typeof a.reason.idProduct&&"undefined"!==typeof a.reason.linkAction&&
"delete-from-cart"===a.reason.linkAction){b=a.reason.idProduct;a=a.reason.idProductAttribute;var d=null;for(f in UserEngage.shopping_cart)if(c=$.extend(!0,{},UserEngage.shopping_cart[f]),parseInt(b)===parseInt(c.id_product)&&parseInt(a)===parseInt(c.id_product_attribute)){d=c;break}null!==d&&UserEngage.event.product.remove(d)}else if("undefined"!==typeof a.reason&&("undefined"!==typeof a.reason.productId&&a.reason.productId||"undefined"!==typeof a.reason.id_product&&a.reason.id_product)){var e=0;
e="undefined"!==typeof a.reason.productId?a.reason.productId:a.reason.id_product;$.ajax({dataType:"json",url:$(".js-cart").data("refresh-url").replace("refresh","update")}).success(function(a){prestashop.cart=a.cart;for(var c in UserEngage.shopping_cart)if(a=$.extend(!0,{},UserEngage.shopping_cart[c]),parseInt(e)===parseInt(a.id_product)){var b=null,f;for(f in prestashop.cart.products){var d=$.extend(!0,{},prestashop.cart.products[f]);if(parseInt(e)===parseInt(d.id_product)&&parseInt(a.id_product_attribute)===
parseInt(d.id_product_attribute)&&parseInt(a.cart_quantity)!==parseInt(d.cart_quantity)){b=d;break}}null!==b?a.cart_quantity<b.cart_quantity?(b.cart_quantity=Math.abs(parseInt(a.cart_quantity)-parseInt(b.cart_quantity)),UserEngage.event.product.addToCart(b)):(b.cart_quantity=Math.abs(parseInt(a.cart_quantity)-parseInt(b.cart_quantity)),UserEngage.event.product.remove(b)):UserEngage.event.product.remove(a)}})}});$(document).on("click",".product-miniature a",function(a){a.preventDefault();a=$(this).closest('[itemtype="http://schema.org/Product"]');
var b=$(this).attr("href").trim();setTimeout(function(){document.location=b},500);var c={name:a.find('[itemprop="name"]').text().trim(),product_id:a.attr("data-id-product")+"-"+a.attr("data-id-product-attribute"),product_url:b,price:a.find('[itemprop="price"]').text().trim().replace(/([^0-9\.,]+)/g,"").replace(",",".")};a.find("img").length&&(c.image_url=a.find("img").eq(0).attr("src"));a.find(".discount-product").length?UserEngage.event.product.promoClick(c):UserEngage.event.product.click(c);return!1});
if("product"===$("body").attr("id")){UserEngage.event.product.view();var a=!1;$(document).on("scroll",function(){var b=$("#product-details").closest(".tabs");if(!a&&b.is(":visible")){var c=$(window).scrollTop(),d=c+$(window).height();b=b.offset().top;b<=d&&b>=c&&(UserEngage.event.product.detail(),a=!0)}});prestashop.on("updatedProduct",function(a){UserEngage.event.product.view()})}if("cart"===$("body").attr("id"))for(var b in prestashop.cart.products){var c=prestashop.cart.products[b],d={name:c.name,
product_id:c.id_product+"-"+c.id_product_attribute,price:c.price_wt,product_url:c.url,category_name:c.category,quantity:c.cart_quantity};null!==c.cover&&null!==c.cover.medium&&(d.image_url=c.cover.medium.url);for(var e in c.attributes)d[e]=c.attributes[e];UserEngage.event.product.checkout(d)}if("checkout"===$("body").attr("id")){b=0;switch($(".js-current-step").attr("id")){case "checkout-personal-information-step":b=1;break;case "checkout-addresses-step":b=2;break;case "checkout-delivery-step":b=
3;break;case "checkout-payment-step":b=4}UserEngage.event.order(b)}UserEngage.watchForNewsletterSubmit=function(a){var b=!1;a.on("submit",function(c){if(!b){b=!0;c.preventDefault();setTimeout(function(){a.trigger("submit")},500);if(!a.find('[name="newsletter"][type="checkbox"]').length||a.find('[name="newsletter"][type="checkbox"]').eq(0).is(":checked"))c=a.find('[name="email"]').eq(0).val(),UserEngage.event.newsletter(c,document.location.href);return!1}})};$('[name="submitNewsletter"]').length&&
UserEngage.watchForNewsletterSubmit($('[name="submitNewsletter"]').closest("form"));UserEngage.watchForDeliveryMessageSubmit=function(a){var b=!1;a.on("submit",function(c){if(!b)return b=!0,c.preventDefault(),setTimeout(function(){a.find('[type="submit"]').trigger("click")},500),c=a.find("#delivery_message").eq(0).val().trim(),c.length&&UserEngage.event.checkoutOption({additional_information:c}),!1})};$("#delivery_message").length&&UserEngage.watchForDeliveryMessageSubmit($("#delivery_message").closest("form"));
if("product"===$("body").attr("id"))$(document).on("click",".social-sharing a",function(){UserEngage.event.product.liking()})});
